<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="scsidisk" />
    <title>实时查询memcached状态的两个快捷命令 | scsidisk</title>
    <link href="/feed/" rel="alternate" title="scsidisk" type="application/atom+xml" />
    <link rel="stylesheet" href="/media/css/highlight.css">
    <link href='/media/webfonts/ss-social.css' rel='stylesheet'>
    <link href='/media/webfonts/ss-standard.css' rel='stylesheet'>
    <link href="/media/css/screen.css" rel="stylesheet">

    <script type="text/javascript" src="/media/js/jquery-1.7.1.min.js"></script>
  </head>
  <body>
    <div id="container">
      <div id="main" role="main">
        <header>
        <div class="buttons">
          <a href="/" class="ss-icon" title="Go to homepage">home</a>
          <a href="/categories" class="ss-icon" title="Category" >list</a>
          <a href="/tags" class="ss-icon" title="Tag Cloud" >tags</a>
          <a href="/guestbook" class="ss-icon" title="Guest Book" >talk</a>
          <a href="/about" class="ss-icon" title="About" >user</a>
          <a href="/feed" class="ss-icon" title="Subscribe by RSS" >rss</a>
        </div>
        <h1>实时查询memcached状态的两个快捷命令</h1>
        </header>
        <hr>
        <article class="content">
        <section class="post">
<p>查询实时的状态，类似于“top”命令。</p>

<p>在命令行下执行任一命令（第二个办法需要通过php）：</p>

<ol>
<li>使用shell</li>
</ol>


<pre><code>​$ watch "echo stats | nc 127.0.0.1 11211"
</code></pre>

<p>结果如下：</p>

<pre><code>STAT pid 13785
STAT uptime 1377436
STAT time 1227764242
STAT version 1.2.6
STAT pointer\_size 32
STAT rusage\_user 9.265591
STAT rusage\_system 36.541444
STAT curr\_items 6
STAT total\_items 1093
STAT bytes 24628
STAT curr\_connections 19
STAT total\_connections 79352
STAT connection\_structures 117
STAT cmd\_get 609575
STAT cmd\_set 1093
STAT get\_hits 608483
STAT get\_misses 1092
STAT evictions 0
STAT bytes\_read 14703639
STAT bytes\_written 2297950214
STAT limit\_maxbytes 52428800
STAT threads 1
END
</code></pre>

<ol>
<li>使用php进行查询</li>
</ol>


<pre><code>​watch '/www/php/bin/php -r '"'"'\$m=new Memcache;\$m-\&gt;connect("127.0.0.1", 11211);print\_r(\$m-\&gt;getstats());'"'"
</code></pre>

<p>结果如下：</p>

<pre><code>Array
(
[pid] =\&gt; 13785
[uptime] =\&gt; 1377469
[time] =\&gt; 1227764275
[version] =\&gt; 1.2.6
[pointer\_size] =\&gt; 32
[rusage\_user] =\&gt; 9.266591
[rusage\_system] =\&gt; 36.541444
[curr\_items] =\&gt; 6
[total\_items] =\&gt; 1093
[bytes] =\&gt; 24628
[curr\_connections] =\&gt; 16
[total\_connections] =\&gt; 79372
[connection\_structures] =\&gt; 117
[cmd\_get] =\&gt; 609593
[cmd\_set] =\&gt; 1093
[get\_hits] =\&gt; 608501
[get\_misses] =\&gt; 1092
[evictions] =\&gt; 0
[bytes\_read] =\&gt; 14704073
[bytes\_written] =\&gt; 2298032330
[limit\_maxbytes] =\&gt; 52428800
[threads] =\&gt; 1
)
</code></pre>

<p>上面命令假设memcached按默认情况运行，即服务器地址为127.0.0.1，端口为11211。请按实际情况修改。</p>

<p>转载:http://blog.csdn.net/haohappy2004/article/details/3390336</p>

</section>
<section class="meta">
<span class="author">
  <a href="http://scsidisk.github.io">scsidisk</a>
</span>
<span class="time">
  /
  <time datetime="2013-09-29">2013-09-29</time>
</span>
<br />
<span class="license">
  Published under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">(CC) BY-NC-SA</a>
</span>

<span class="categories">
  in categories
  
  <a href="/categories/#memcache" title="memcache">memcache</a>&nbsp;
  
</span>


<span class="tags">
  tagged with
  
  <a href="/tags/#Linux," title="Linux,">Linux,</a>&nbsp;
  
  <a href="/tags/#memcache," title="memcache,">memcache,</a>&nbsp;
  
  <a href="/tags/#PHP" title="PHP">PHP</a>&nbsp;
  
</span>

</section>
<section class="comment">
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'scsidiskgithuio'; // required: replace example with your forum shortname
    var disqus_url = 'http://scsidisk.github.io/2013/09/real_time_query_memcached_state_of_the_two_shortcut/';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>


<script type="text/javascript">
$(function(){
  $(document).keydown(function(e) {
    var url = false;
        if (e.which == 37 || e.which == 74) {  // Left arrow and J
            
        url = 'http://scsidisk.github.io/2013/05/sphider_and_scws_build_php_search_egine/';
        
        }
        else if (e.which == 39 || e.which == 75) {  // Right arrow and K
            
        url = 'http://scsidisk.github.io/2013/10/vim_find_and_replace/';
        
        }
        if (url) {
            window.location = url;
        }
  });
})
</script>


        </article>
      </div>

    <footer>
        <p><small>Powered by <a href="https://github.com/mojombo/jekyll">Jekyll</a> | Copyright 2008 - 2014 by <a href="http://scsidisk.github.io">scsidisk</a> | <span class="label label-info">2014-06-10 02:55:31 CST</span></small></p>
    </footer>

    </div>

    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', '');
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>
</html>
