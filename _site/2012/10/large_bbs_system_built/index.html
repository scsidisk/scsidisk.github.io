<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="scsidisk" />
    <title>关于大型论坛系统环境搭建 | scsidisk</title>
    <link href="/feed/" rel="alternate" title="scsidisk" type="application/atom+xml" />
    <link rel="stylesheet" href="/media/css/highlight.css">
    <link href='/media/webfonts/ss-social.css' rel='stylesheet'>
    <link href='/media/webfonts/ss-standard.css' rel='stylesheet'>
    <link href="/media/css/screen.css" rel="stylesheet">

    <script type="text/javascript" src="/media/js/jquery-1.7.1.min.js"></script>
  </head>
  <body>
    <div id="container">
      <div id="main" role="main">
        <header>
        <div class="buttons">
          <a href="/" class="ss-icon" title="Go to homepage">home</a>
          <a href="/categories" class="ss-icon" title="Category" >list</a>
          <a href="/tags" class="ss-icon" title="Tag Cloud" >tags</a>
          <a href="/guestbook" class="ss-icon" title="Guest Book" >talk</a>
          <a href="/about" class="ss-icon" title="About" >user</a>
          <a href="/feed" class="ss-icon" title="Subscribe by RSS" >rss</a>
        </div>
        <h1>ScsiDisk's Blog</h1>
        </header>
        <hr>
        <article class="content">
        <h2>关于大型论坛系统环境搭建</h2>

<section class="post">
<p>关于大型论坛系统环境搭建(20万日IP负载平衡实战)-Nginx+Apache2+PHP+MySQL</p>

<p>（本文只针对Discuz论坛系统讨论，由于软件包更新速度比较快，你看本贴的时候可能已经是使用新版本的软件包了，安装方法可能不一致，详细请查看软件包的README文件）</p>

<h3 id="测试环境:理想论坛(55188).">测试环境:理想论坛(55188).</h3>

<p>理想论坛为国内人气最旺的股票论坛，注册会员已超过100万，并以每月60000人的速度稳定递增，每日页面访问量超过200万，并保持稳定增长的趋势,60分钟在线平均约2万多人，最高记录3万3千多。 目前主题超过30万，帖子接近1千万，数据库大小5.8GB，附件总大小大约150GB</p>

<p>之前理想论坛有三台服务器，两台WEB服务器以及一台数据库服务器，访问已经渐渐出现瓶颈，在猪头的建议下，站长决定增加一台服务器放数据库，另外三台做WEB，并且对原有的服务器的操作系统进行升级。</p>

<h3 id="硬件具体情况">硬件具体情况</h3>

<p>MySQL服务器： DualXeon 5335/8GB内存/73G SAS硬盘（RAID0+1）/CentOS5.1-x86_64/MySQL5</p>

<p>三台WEB服务器如下：</p>

<p>N1. Dual Xeon 3.0 2GB 内存<br>
N1. Dual Xeon 3.0 4GB 内存<br>
N1. Dual Xeon 3.0(双核) 4G内存   </p>

<p>另外有三块300G的SCSI硬盘准备做RAID5，用来存放附件,四台机器通过内网连接</p>

<p>猪头考虑过的解决方案如下:</p>

<ol>
<li>ZEUS + PHP5 + eAccelerator</li>
<li>squid + Apache2 + PHP + eAccelerator</li>
<li>nginx + PHP(fastcgi) + eAccelerator</li>
<li>nginx + Apache2 + PHP + eAccelerator</li>
</ol>

<p>第一个方案，属于比较完美的，而且很稳定，但是最大的问题是ZEUS是收费软件，用盗版总会受良心责备的,所以暂时押后做候补方案</p>

<p>第二个方案，squid转发请求给Apache2，很多网站都采用这种方式，而且效率也非常高，猪头也测试了一下，但是问题非常严重，因为squid是把文件缓存起来的，所以每一个访问过的文件，squid都要把它打开，理想论坛拥有150G的附件，而且访问量巨大，这种情况下只有打开squid，机器很快就会因为打开文件过多而拒绝响应任何请求了,看来也不适合,只适合缓存文件只有几百M以内的网站.</p>

<p>第三个方案，猪头对第三个方案的测试结果是访问量大的时候，PHP经常会出现bad gateway，看来通过TCP连接Fastcgi执行PHP的方法不够稳定，猪头也测试了通过Unix Socket连接执行PHP，同样还是不稳定.</p>

<p>对比之下，猪头目前使用了第四种解决方案.</p>

<h3 id="apache2的安装。">Apache2的安装。</h3>

<p>(由于服务器采用FreeBSD7，所以大部分软件将会通过ports安装)</p>

<p>由于Apache2只需要处理PHP请求，所以其他模块基本上都不需要，所以不要选择安装其他模块，即使rewrite也不需要，因为rewrite将会在nginx上面实现，如果熟悉，还可以修改Makefile删掉不需要的部分，这样经过优化之后，apache将会以最稳定最高效的方式处理PHP请求</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">cd /usr/ports/www/apache20
make install clean
</code></pre></div>
<p>修改httpd.conf(这里仅列出要修改/增加的部分)</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">vi /usr/local/etc/apache2/httpd.conf
</code></pre></div>
<p>把KeepAlive On修改为KeepAlive Off，在下面添加</p>
<div class="highlight"><pre><code class="language-apache" data-lang="apache"><span class="nb">ServerLimit</span> <span class="m">2048</span>
<span class="c"># MaxClients增加到512</span>
<span class="nb">Listen</span> <span class="m">127.0.0.1</span>:81 #由于httpd服务器不需要对外开放，仅仅处理nginx转发过来的PHP请求，所以仅仅需要监听本地的端口.
</code></pre></div>
<p>另外增加对PHP的支持</p>
<div class="highlight"><pre><code class="language-apache" data-lang="apache"><span class="nb">AddType</span> application/x-httpd-php .php
<span class="nb">AddType</span> application/x-httpd-php-source .phps
</code></pre></div>
<p>至于添加虚拟主机的部分将不再罗嗦，注意虚拟主机也监听本地81端口就可以了</p>

<h3 id="php5的安装(gd库等模块请提前装好)">PHP5的安装(GD库等模块请提前装好)</h3>
<div class="highlight"><pre><code class="language-text" data-lang="text">cd /usr/ports/lang/php5
</code></pre></div>
<p>修改一下Makefile，把需要的东西加上去吧</p>

<p>本来应该有这样一段的</p>
<div class="highlight"><pre><code class="language-make" data-lang="make"><span class="nv">CONFIGURE_ARGS</span><span class="o">=</span> <span class="se">\</span>
-with-layout<span class="o">=</span>GNU <span class="se">\</span>
-with-config-file-scan-dir<span class="o">=</span><span class="k">${</span><span class="nv">PREFIX</span><span class="k">}</span>/etc/php <span class="se">\</span>
-disable-all <span class="se">\</span>
-enable-libxml <span class="se">\</span>
-with-libxml-dir<span class="o">=</span><span class="k">${</span><span class="nv">LOCALBASE</span><span class="k">}</span> <span class="se">\</span>
-enable-reflection <span class="se">\</span>
<span class="nv">-program-prefix</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
</code></pre></div>
<p>我们要把它修改成</p>
<div class="highlight"><pre><code class="language-make" data-lang="make"><span class="nv">CONFIGURE_ARGS</span><span class="o">=</span> <span class="se">\</span>
-with-layout<span class="o">=</span>GNU <span class="se">\</span>
-with-config-file-scan-dir<span class="o">=</span><span class="k">${</span><span class="nv">PREFIX</span><span class="k">}</span>/etc/php <span class="se">\</span>
-disable-all <span class="se">\</span>
-enable-libxml <span class="se">\</span>
-with-libxml-dir<span class="o">=</span><span class="k">${</span><span class="nv">LOCALBASE</span><span class="k">}</span> <span class="se">\</span>
-enable-reflection <span class="se">\</span>
-program-prefix<span class="o">=</span><span class="s2">&quot;&quot;</span> <span class="se">\</span>
<span class="nv">-with-config-file-path</span><span class="o">=</span>/etc -enable-mbstring -enable-ftp -with-gd -with-jpeg-dir<span class="o">=</span>/usr/local -with-png-dir<span class="o">=</span>/usr/local -enable-magic-quotes -with-mysql<span class="o">=</span>/usr/local -with-pear -enable-sockets -with-ttf -with-freetype-dir<span class="o">=</span>/usr/local -enable-gd-native-ttf -with-zlib -enable-sysvsem -enable-sysvshm -with-libxml-dir<span class="o">=</span>/usr/local -with-pcre-regex -enable-xml
</code></pre></div>
<p>安装</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">make install clean
cp work/php-5.2.5/php.ini-dist /etc/php.ini
</code></pre></div>
<h3 id="安装eaccelerator">安装eAccelerator</h3>
<div class="highlight"><pre><code class="language-text" data-lang="text">cd /usr/ports/www/eaccelerator
make install clean
</code></pre></div>
<p>把以下部分添加到php.ini尾端:</p>
<div class="highlight"><pre><code class="language-ini" data-lang="ini"><span class="na">extension_dir</span><span class="o">=</span><span class="s">&quot;/usr/local/lib/php/20060613/&quot;</span>
<span class="na">extension</span><span class="o">=</span><span class="s">&quot;eaccelerator.so&quot;</span>
<span class="na">eaccelerator.cache_dir</span><span class="o">=</span><span class="s">&quot;/tmp/eaccelerator&quot;</span>
<span class="na">eaccelerator.shm_size</span><span class="o">=</span><span class="s">&quot;64&quot;</span>
<span class="na">eaccelerator.enable</span><span class="o">=</span><span class="s">&quot;1&quot;</span>
<span class="na">eaccelerator.optimizer</span><span class="o">=</span><span class="s">&quot;1&quot;</span>
<span class="na">eaccelerator.check_mtime</span><span class="o">=</span><span class="s">&quot;1&quot;</span>
<span class="na">eaccelerator.debug</span><span class="o">=</span><span class="s">&quot;0&quot;</span>
<span class="na">eaccelerator.filter</span><span class="o">=</span><span class="s">&quot;&quot;</span>
<span class="na">eaccelerator.shm_max</span><span class="o">=</span><span class="s">&quot;0&quot;</span>
<span class="na">eaccelerator.shm_ttl</span><span class="o">=</span><span class="s">&quot;60&quot;</span>
<span class="na">eaccelerator.shm_prune_period</span><span class="o">=</span><span class="s">&quot;60&quot;</span>
<span class="na">eaccelerator.shm_only</span><span class="o">=</span><span class="s">&quot;0&quot;</span>
<span class="na">eaccelerator.compress</span><span class="o">=</span><span class="s">&quot;1&quot;</span>
<span class="na">eaccelerator.compress_level</span><span class="o">=</span><span class="s">&quot;9&quot;</span>
<span class="na">eaccelerator.keys</span><span class="o">=</span><span class="s">&quot;shm_and_disk&quot;</span>
<span class="na">eaccelerator.sessions</span><span class="o">=</span><span class="s">&quot;shm_and_disk&quot;</span>
<span class="na">eaccelerator.content</span><span class="o">=</span><span class="s">&quot;shm_and_disk&quot;</span>
</code></pre></div>
<p>建立缓存目录以及修改权限</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mkdir /tmp/eaccelerator
chmod 777 /tmp/eaccelerator
chown nobody:nobody /tmp/eaccelerator
</code></pre></div>
<h3 id="nginx的安装以及配置">nginx的安装以及配置</h3>
<div class="highlight"><pre><code class="language-text" data-lang="text">cd /usr/ports/www/nginx
make install
</code></pre></div>
<p>有几个module是我们需要的，要选上</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">HTTP module
http_addition module
http_rewrite module
http_realip module
http_stub_status module
</code></pre></div>
<p>其他的看自己需要了</p>

<p>修改配置文件</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">vi /usr/local/etc/nginx/nginx.conf
</code></pre></div><div class="highlight"><pre><code class="language-nginx" data-lang="nginx"><span class="k">user</span> <span class="s">nobody</span> <span class="s">nobody</span><span class="p">;</span>
<span class="k">worker_processes</span> <span class="mi">4</span><span class="p">;</span>
<span class="c1">#error_log logs/error.log;</span>
<span class="c1">#error_log logs/error.log notice;</span>
<span class="c1">#error_log logs/error.log info;</span>
<span class="c1">#pid /var/log/nginx.pid;</span>
<span class="k">events</span> <span class="p">{</span>
    <span class="kn">worker_connections</span> <span class="mi">10240</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">http</span> <span class="p">{</span>
    <span class="kn">include</span> <span class="s">mime.types</span><span class="p">;</span>
    <span class="kn">default_type</span> <span class="s">application/octet-stream</span><span class="p">;</span>
    <span class="kn">limit_zone</span> <span class="no">on</span><span class="s">e</span> <span class="nv">$binary_remote_addr</span> <span class="mi">10m</span><span class="p">;</span>
    <span class="c1">#log_format main &#39;$remote_addr - $remote_user [$time_local] $request &#39;</span>
    <span class="c1"># &#39;&quot;$status&quot; $body_bytes_sent “$http_referer&quot; &#39;</span>
    <span class="c1"># &#39;&quot;$http_user_agent&quot; “$http_x_forwarded_for&quot;&#39;;</span>
    <span class="kn">sendfile</span> <span class="no">off</span><span class="p">;</span>
    <span class="kn">tcp_nopush</span> <span class="no">off</span><span class="p">;</span>
    <span class="c1">#keepalive_timeout 0;</span>
    <span class="kn">keepalive_timeout</span> <span class="mi">10</span><span class="p">;</span>
    <span class="kn">gzip</span> <span class="no">off</span><span class="p">;</span>
    <span class="kn">server</span> <span class="p">{</span>
        <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
        <span class="kn">server_name</span> <span class="s">www.55188.net</span> <span class="s">www.55188.com</span> <span class="s">www1.55188.com</span> <span class="s">www2.55188.com</span> <span class="mi">55188</span><span class="s">.com</span> <span class="mi">55188</span><span class="s">.net</span> <span class="s">www.55188.cn</span> <span class="mi">55188</span><span class="s">.cn</span> <span class="s">bbs.55188.net</span> <span class="s">bbs.55188.com</span> <span class="s">bbs.55188.cn</span><span class="p">;</span>
        <span class="kn">index</span> <span class="s">index.html</span> <span class="s">index.htm</span> <span class="s">index.php</span><span class="p">;</span>
        <span class="kn">root</span> <span class="s">/home/www</span><span class="p">;</span>
        <span class="kn">access_log</span> <span class="s">/dev/null</span> <span class="s">combined</span><span class="p">;</span>
        <span class="kn">limit_conn</span> <span class="no">on</span><span class="s">e</span> <span class="mi">5</span><span class="p">;</span><span class="c1">#限制一个IP并发连接数为五个</span>
        <span class="kn">error_page</span> <span class="mi">404</span> <span class="s">/404.html</span><span class="p">;</span>
        <span class="kn">error_page</span> <span class="mi">403</span> <span class="s">/403.html</span><span class="p">;</span>
        <span class="kn">location</span> <span class="s">/status</span> <span class="p">{</span>
            <span class="kn">stub_status</span> <span class="no">on</span><span class="p">;</span>
            <span class="kn">access_log</span> <span class="no">off</span><span class="p">;</span>
            <span class="kn">auth_basic</span> <span class="s">“NginxStatus&quot;</span><span class="p">;</span>
            <span class="kn">auth_basic_user_file</span> <span class="s">conf/htpasswd</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="c1">#在根目录使用Discuz6.0 rewrite规则,如果你的论坛在二级目录下面,则要相应修改location</span>
        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
            <span class="kn">rewrite</span> <span class="s">^/archiver/((fid|tid)-[\w\-]+\.html)</span>$ <span class="s">/archiver/index.php?</span><span class="nv">$1</span> <span class="s">last</span><span class="p">;</span>
            <span class="kn">rewrite</span> <span class="s">^/forum-([0-9]+)-([0-9]+)\.html</span>$ <span class="s">/forumdisplay.php?fid=</span><span class="nv">$1&amp;page=$2</span> <span class="s">last</span><span class="p">;</span>
            <span class="kn">rewrite</span> <span class="s">^/thread-([0-9]+)-([0-9]+)-([0-9]+)\.html</span>$ <span class="s">/viewthread.php?tid=</span><span class="nv">$1&amp;extra=page\%3D$3&amp;page=$2</span> <span class="s">last</span><span class="p">;</span>
            <span class="kn">rewrite</span> <span class="s">^/space-(username|uid)-(.+)\.html</span>$ <span class="s">/space.php?</span><span class="nv">$1=$2</span> <span class="s">last</span><span class="p">;</span>
            <span class="kn">rewrite</span> <span class="s">^/tag-(.+)\.html</span>$ <span class="s">/tag.php?name=</span><span class="nv">$1</span> <span class="s">last</span><span class="p">;</span>
            <span class="kn">break</span><span class="p">;</span>
            <span class="kn">error_page</span> <span class="mi">404</span> <span class="s">/404.html</span><span class="p">;</span>
            <span class="kn">error_page</span> <span class="mi">403</span> <span class="s">/403.html</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="c1">#对附件做防盗链,没有正确的referer将会返回403页面</span>
        <span class="kn">location</span> <span class="p">~</span><span class="sr">*</span> <span class="s">^.+\.(gif|jpg|png|swf|flv|rar|zip|doc|pdf|gz|bz2|jpeg|bmp|xls)</span>$ <span class="p">{</span>
            <span class="kn">valid_referers</span> <span class="s">none</span> <span class="s">blocked</span> <span class="s">server_names</span> <span class="s">*.55188.net</span> <span class="s">*.55188.com</span><span class="p">;</span>
            <span class="kn">if</span> <span class="s">(</span><span class="nv">$invalid_referer</span><span class="s">)</span> <span class="p">{</span>
                <span class="kn">rewrite</span> <span class="s">^/</span> <span class="s">http://www.55188.com/403.html</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="c1">#转发PHP请求到本地的81端口,让Apache处理.</span>
        <span class="kn">location</span> <span class="p">~</span> <span class="sr">\.php$</span> <span class="p">{</span>
            <span class="kn">proxy_pass</span> <span class="s">http://127.0.0.1:81</span><span class="p">;</span>
            <span class="kn">proxy_redirect</span> <span class="no">off</span><span class="p">;</span>
            <span class="kn">proxy_set_header</span> <span class="s">Host</span> <span class="nv">$host</span><span class="p">;</span>
            <span class="kn">proxy_set_header</span> <span class="s">X-Real-IP</span> <span class="nv">$remote_addr</span><span class="p">;</span>
            <span class="kn">proxy_set_header</span> <span class="s">X-Forwarded-For</span> <span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
            <span class="kn">proxy_hide_header</span> <span class="s">Content-Type</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>测试一下你的配置文件是否都正确</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">/usr/local/sbin/apachectl configtest
/usr/local/sbin/nginx -t
</code></pre></div>
<p>都没问题的话就启动服务器吧</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">/usr/local/sbin/apachectl start
/usr/local/sbin/nginx -c /usr/local/etc/nginx/nginx.conf
</code></pre></div>
<p>浏览一下主页，应该正常了</p>

<h3 id="后继讨论，">后继讨论，</h3>

<h4 id="1.数据库.">1.数据库.</h4>

<p>数据库的编译安装不再重复讨论，仅仅讨论环境，由于理想论坛的数据库比较大，而且发展比较快，所以要作比较前一点的预算，硬盘需要使用15K RPM的SAS硬盘做RAID0+1，操作系统需要使用64位版本，因为服务器需要8GB内存，要注意的时，使用了64位系统之后部分比较老的软件可能你无法找到64位的版本，这台机器就专门做MySQL服务器吧，如果数据库超过10G，应该考虑MySQL_Cluster</p>

<h4 id="2.附件.">2.附件.</h4>

<p>因为有三台服务器做WEB，所以附件要使用nfs的方式通过内网进行共享，至于如何设置nfs这里不再讨论，如果有不明白的请将学费交给Google</p>

<h4 id="3.web.">3.WEB.</h4>

<p>由于三台机器硬件配置不一致,所以有必要考虑一下负载平衡的问题,nginx本身附带有负载平衡的功能,但是如果启用负载平衡的功能的话,每台机器都将会把客户端请求的数据缓存到本机,这样增加了硬盘的IO,对于理想论坛的访问量来说,这是个不小的开销,最后我们是使用DNS查询的方式来分配流量, 通过不同的A记录,配置好点的机器，多分一条A记录，配置差的就少一条A记录，这样从整体上看，流量分配应该比较平衡.</p>

<h4 id="4.关于nginx并发连接">4.关于nginx并发连接</h4>

<p>猪头给nginx限制了每个IP的并发连接，因为对于大论坛来说，总是比较出名的，不说人家攻击你什么的.采集都特别多,如果不限制,很容易出问题,经常会导致PHP罢工.
以上只是猪头愚见，如果有其他进展，猪头会更新本贴，如有疑问或者不同见解，欢迎提出讨论
当然还有很多很疯狂的方法，例如说把WEB文件(附件除外)全部放内存里面，MYSQL如果小于5G，也可以全部放内存里面，不过这些方法都是太极端的了，优化效果须然好，但是风险很大。</p>

<h3 id="优化之后的效果">优化之后的效果</h3>

<p>由于还有两台机器升级没完成，只帖一下其中一台WEB的状况了。目前</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">Active connections: 1143
server accepts handled requests
1211445 1211445 6221785
Reading: 67 Writing: 136 Waiting: 940
</code></pre></div>
<p>Apache最优化要关闭不用的模块，因为httpd请求全部让nginx处理了，Apache仅仅需要处理PHP就可以了，目前我开启的模块</p>
<div class="highlight"><pre><code class="language-apache" data-lang="apache"><span class="nb">LoadModule</span> access_module libexec/apache2/mod_access.so
<span class="nb">LoadModule</span> setenvif_module libexec/apache2/mod_setenvif.so
<span class="nb">LoadModule</span> mime_module libexec/apache2/mod_mime.so
<span class="nb">LoadModule</span> autoindex_module libexec/apache2/mod_autoindex.so
<span class="nb">LoadModule</span> negotiation_module libexec/apache2/mod_negotiation.so
<span class="nb">LoadModule</span> alias_module libexec/apache2/mod_alias.so
<span class="nb">LoadModule</span> rewrite_module libexec/apache2/mod_rewrite.so
<span class="nb">LoadModule</span> php5_module libexec/apache2/libphp5.so
</code></pre></div>
<p>autoindex negotiation以及rewrite这些应该都关闭的，但是要做相应的修改.目前跑起来绝对比Fastcgi要好</p>

</section>
<section class="meta">
<span class="author">
  <a href="http://scsidisk.github.io">scsidisk</a>
</span>
<span class="time">
  /
  <time datetime="2012-10-31">2012-10-31</time>
</span>
<br />
<span class="license">
  Published under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">(CC) BY-NC-SA</a>
</span>

<span class="categories">
  in categories
  
  <a href="/categories/#php" title="php">php</a>&nbsp;
  
</span>


<span class="tags">
  tagged with
  
  <a href="/tags/#Nginx," title="Nginx,">Nginx,</a>&nbsp;
  
  <a href="/tags/#PHP," title="PHP,">PHP,</a>&nbsp;
  
  <a href="/tags/#MySQL," title="MySQL,">MySQL,</a>&nbsp;
  
  <a href="/tags/#Apache" title="Apache">Apache</a>&nbsp;
  
</span>

</section>
<section class="comment">
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'scsidiskgithubio'; // required: replace example with your forum shortname
    var disqus_url = 'http://scsidisk.github.io/2012/10/large_bbs_system_built/';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>


<script type="text/javascript">
$(function(){
  $(document).keydown(function(e) {
    var url = false;
        if (e.which == 37 || e.which == 74) {  // Left arrow and J
            
        url = 'http://scsidisk.github.io/2012/10/php_error_level_and_code/';
        
        }
        else if (e.which == 39 || e.which == 75) {  // Right arrow and K
            
        url = 'http://scsidisk.github.io/2012/10/set_vhost_of_nginx/';
        
        }
        if (url) {
            window.location = url;
        }
  });
})
</script>


        </article>
      </div>

    <footer>
        <p><small>Powered by <a href="https://github.com/mojombo/jekyll">Jekyll</a> | Copyright 2008 - 2014 by <a href="http://scsidisk.github.io">scsidisk</a> | <span class="label label-info">2014-06-16 20:56:29 CST</span></small></p>
    </footer>

    </div>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-51832101-1', 'scsidisk.github.io');
      ga('send', 'pageview');

    </script>
    <script type="text/javascript">
      // var _gaq = _gaq || [];
      // _gaq.push(['_setAccount', '');
      // _gaq.push(['_trackPageview']);
      // (function() {
      //   var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      //   ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      //   var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      // })();
    </script>
  </body>
</html>
